<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Command-line compiling &#8212; Intermediate Modern C++ Overview</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../../_static/clickable.css?v=58C4E18A" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabbedstuff.css?v=424F1CC9" />
    <link rel="stylesheet" type="text/css" href="../../_static/fitb.css?v=3BA0E63E" />
    <link rel="stylesheet" type="text/css" href="../../_static/video.css?v=-1AC7A4C5" />
    <link rel="stylesheet" type="text/css" href="../../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../../_static/webglinteractive.css?v=-6EF20E1F" />
    <link rel="stylesheet" type="text/css" href="../../_static/codemirror.css?v=1CE53237" />
    <link rel="stylesheet" type="text/css" href="../../_static/reveal.css?v=4A81D381" />
    <link rel="stylesheet" type="text/css" href="../../_static/parsons.css?v=2F3E13EE" />
    <link rel="stylesheet" type="text/css" href="../../_static/js_lib/prettify.css?v=2A364B6B" />
    <link rel="stylesheet" type="text/css" href="../../_static/pytutor.css?v=239FC54E" />
    <link rel="stylesheet" type="text/css" href="../../_static/modal-basic.css?v=-75E5BD1C" />
    <link rel="stylesheet" type="text/css" href="../../_static/activecode.css?v=-B8E06A5" />
    <link rel="stylesheet" type="text/css" href="../../_static/datafile.css?v=-3E7B1476" />
    <link rel="stylesheet" type="text/css" href="../../_static/showEval.css?v=C6382F3" />
    <link rel="stylesheet" type="text/css" href="../../_static/accessibility.css?v=-7F7467D6" />
    <link rel="stylesheet" type="text/css" href="../../_static/dragndrop.css?v=-46455F2F" />
    <link rel="stylesheet" type="text/css" href="../../_static/poll.css?v=-1DDF53CD" />
    <link rel="stylesheet" href="../../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/runestonebase.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/matrixeq.js?v=-29B305A6"></script>
    <script type="text/javascript" src="../../_static/clickable.js?v=-6A9F19A2"></script>
    <script type="text/javascript" src="../../_static/timedclickable.js?v=-6C6763DD"></script>
    <script type="text/javascript" src="../../_static/tabbedstuff.js?v=5BE6106"></script>
    <script type="text/javascript" src="../../_static/fitb.js?v=-71BF18ED"></script>
    <script type="text/javascript" src="../../_static/timedfitb.js?v=2AA17071"></script>
    <script type="text/javascript" src="../../_static/runestonevideo.js?v=53E888DE"></script>
    <script type="text/javascript" src="../../_static/codemirror.js?v=-6B0AAD37"></script>
    <script type="text/javascript" src="../../_static/xml.js?v=236EDFF7"></script>
    <script type="text/javascript" src="../../_static/css.js?v=623153CE"></script>
    <script type="text/javascript" src="../../_static/htmlmixed.js?v=33B91944"></script>
    <script type="text/javascript" src="../../_static/javascript.js?v=6F38CA04"></script>
    <script type="text/javascript" src="../../_static/webglinteractive.js?v=2B768384"></script>
    <script type="text/javascript" src="../../_static/FileSaver.min.js?v=-7BF73669"></script>
    <script type="text/javascript" src="../../_static/Blob.js?v=AEC2447"></script>
    <script type="text/javascript" src="../../_static/reveal.js?v=112CBFA2"></script>
    <script type="text/javascript" src="../../_static/js_lib/prettify.js?v=-358176D8"></script>
    <script type="text/javascript" src="../../_static/js_lib/hammer.min.js?v=73056367"></script>
    <script type="text/javascript" src="../../_static/parsons.js?v=-6C1000C7"></script>
    <script type="text/javascript" src="../../_static/timedparsons.js?v=2EEA9E5A"></script>
    <script type="text/javascript" src="../../_static/animationbase.js?v=-5FBC3C59"></script>
    <script type="text/javascript" src="../../_static/mchoice.js?v=6E285D06"></script>
    <script type="text/javascript" src="../../_static/timedmc.js?v=-4FEF5BA9"></script>
    <script type="text/javascript" src="../../_static/timed.js?v=6789FE30"></script>
    <script type="text/javascript" src="../../_static/shortanswer.js?v=-44F4664F"></script>
    <script type="text/javascript" src="../../_static/timed_shortanswer.js?v=-4C5EE829"></script>
    <script type="text/javascript" src="../../_static/d3.v2.min.js?v=836E01C"></script>
    <script type="text/javascript" src="../../_static/jquery.ba-bbq.min.js?v=-49B30F58"></script>
    <script type="text/javascript" src="../../_static/jquery.jsPlumb-1.3.10-all-min.js?v=42F9EBEA"></script>
    <script type="text/javascript" src="../../_static/pytutor.js?v=-7D4FDD47"></script>
    <script type="text/javascript" src="../../_static/codelens.js?v=-354132B7"></script>
    <script type="text/javascript" src="../../_static/jquery.highlight.js?v=-E3B6938"></script>
    <script type="text/javascript" src="../../_static/bookfuncs.js?v=-57645C8C"></script>
    <script type="text/javascript" src="../../_static/python.js?v=14A28F1F"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/CLDRPluralRuleParser.js?v=599B42B0"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.js?v=-775EBCF1"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.messagestore.js?v=-51EA5B5F"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.fallbacks.js?v=-75420181"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.language.js?v=747279FF"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.parser.js?v=7B020E13"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.emitter.js?v=660E85C3"></script>
    <script type="text/javascript" src="../../_static/jquery_i18n/jquery.i18n.emitter.bidi.js?v=54B21948"></script>
    <script type="text/javascript" src="../../_static/activecode-i18n.en.js?v=-6D577C35"></script>
    <script type="text/javascript" src="../../_static/skulpt.min.js?v=75F941D8"></script>
    <script type="text/javascript" src="../../_static/skulpt-stdlib.js?v=-4AE6ECF7"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@4.0.0-rc.2/build/vega.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@2.5.0/build/vega-lite.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@3.14.0/build/vega-embed.js"></script>
    <script type="text/javascript" src="../../_static/activecode.js?v=-F502D84"></script>
    <script type="text/javascript" src="../../_static/clike.js?v=2DCE0756"></script>
    <script type="text/javascript" src="../../_static/timed_activecode.js?v=5150FA78"></script>
    <script type="text/javascript" src="../../_static/datafile.js?v=3ED1A80C"></script>
    <script type="text/javascript" src="../../_static/showEval.js?v=-3A31F37F"></script>
    <script type="text/javascript" src="../../_static/dragndrop.js?v=2B6403E8"></script>
    <script type="text/javascript" src="../../_static/timeddnd.js?v=378F237E"></script>
    <script type="text/javascript" src="../../_static/poll.js?v=6C59AE9F"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Version control" href="version-control.html" />
    <link rel="prev" title="Introducing the vim editor" href="vim.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/intermediate-cpp/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'https://daveparillo.github.io/intermediate-cpp/' ? 'https://daveparillo.github.io/intermediate-cpp/' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/intermediate-cpp';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'intermediate-cpp';
  eBookConfig.acDefaultLanguage = 'cpp' ? 'cpp' : 'cpp'
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = false;
  eBookConfig.basecourse = 'intermediate-cpp';
  eBookConfig.jobehost = 'https://fierce-ridge-58946.herokuapp.com/http://jobe2.cosc.canterbury.ac.nz';
  eBookConfig.proxyuri_runs = '/jobe/index.php/restapi/runs/';
  eBookConfig.proxyuri_files = '/jobe/index.php/restapi/files/';
  eBookConfig.runestone_version = '3.4.6.dev0';
</script>


  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='padding:12px 0;text-align:center' href="http://209.129.16.61/~dparillo/">
           <i class="glyphicon glyphicon-home" style='opacity:0.9;font-size:16px;color:#848484'></i>
        </a>
        <!--
        <a class="brand-logo" style='background: transparent url("../../_static/img/logo_small.png") no-repeat 0px 0px;' href="/intermediate-cpp/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="/~dparillo" style="color:#5080a0">CISC-187</a>&nbsp;
        -->
        <a class="navbar-brand" href="../../index.html">Intermediate C++</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../../index.html'>Table of Contents</a></li>
            
            <li><a href='https://daveparillo.github.io/intermediate-cpp//genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='https://daveparillo.github.io/intermediate-cpp//help/navhelp.html'>Navigation Help</a></li>
            <li><a href='https://daveparillo.github.io/intermediate-cpp//glossary.html'>Glossary</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Command-line compiling</a><ul>
<li><a class="reference internal" href="#the-c-compiler">The C++ compiler</a></li>
<li><a class="reference internal" href="#the-make-utility">The make utility</a></li>
<li><a class="reference internal" href="#running-your-programs">Running your programs</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - Introducing the vim editor" data-toggle="tooltip">
    <a href="vim.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - Version control' data-toggle="tooltip" >
    <a href="version-control.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="command-line-compiling">
<span id="index-0"></span><h1>Command-line compiling<a class="headerlink" href="#command-line-compiling" title="Permalink to this headline">¶</a></h1>
<p>Why in the ‘modern’ era, is there still such focus on command line and
text based tools for programming?
Several actually.</p>
<ul>
<li><p class="first">Command line applications can easily be used in batch files or scripts,
which is essential for automated testing or builds.
On large software projects, even if your team uses an
Integrated Development Environment (IDE), you’ll also need a command line
tool-chain that a machine can execute.</p>
</li>
<li><p class="first">The input, output and error streams can easily be redirected,
allowing information to be sent or received from files or other applications.
This can mean test data can be easily supplied or output captured.</p>
</li>
<li><p class="first">Use over remote shell or similar connections makes it possible to
efficiently perform tasks remotely,
such as when a developer is connecting from home or on the road.</p>
</li>
<li><p class="first">There are defined standards for help
(such as the Unix <strong>man</strong> command or passing -? as an argument).
If someone does not know a feature, they can easily discover what the tool provides.</p>
</li>
<li><p class="first">If you are writing such tools rather than using them,
the command line is easy to develop for.</p>
<p>Accepting arguments on the command line is trivial and
output to a text stream is similarly easy.</p>
</li>
</ul>
<div class="section" id="the-c-compiler">
<span id="index-1"></span><h2>The C++ compiler<a class="headerlink" href="#the-c-compiler" title="Permalink to this headline">¶</a></h2>
<p>There are many programs that will make executables from C++ source.
One popular choice is <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">gcc</span></code>, the Gnu project C and C++ compiler.
<code class="docutils literal highlight highlight-cpp"><span></span><span class="n">gcc</span></code> is free and open-source, meaning that it can be made to run
on many different operating systems.
It also has the advantage of being able to compile more than just C and C++,
although it was developed initially for that.
One of the advantages of using a multi language tool like gcc is that
it potentially minimizes the number of new tools you have to learn
to begin working in a new language.</p>
<p>When you invoke <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">gcc</span></code>, it normally does preprocessing, compilation, assembly and linking.</p>
<div class="graphviz"><img src="../../_images/graphviz-09bce53d7fd4a1253097ac7deee0e1211a20690b.png" alt="Standard executable build steps" class="graphviz" /></div>
<p><code class="docutils literal highlight highlight-cpp"><span></span><span class="n">gcc</span></code> is a complex program with <strong>many</strong> options.
You can execute only one of these steps, some of them,
all of them, or change the behavior of one or more steps.</p>
<p>Generally, we are interested in building our programs as simply as possible.
Given a single source file <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">main</span><span class="p">.</span><span class="n">cpp</span></code>, that contains all the code
needed to describe a working program, it is enough to type:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">++</span> <span class="n">main</span><span class="p">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>This command will perform all of the steps to make an executable
and write the executable to a file named <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">a</span><span class="p">.</span><span class="n">out</span></code>.
Normally, however, we want to give our programs meaningful names:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">++</span> <span class="n">main</span><span class="p">.</span><span class="n">cpp</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span>
</pre></div>
</div>
<p>The <code class="docutils literal highlight highlight-cpp"><span></span><span class="o">-</span><span class="n">o</span></code> switch tells g++ to write the executable to a file named <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">main</span></code>.
We could have added a file extension, like <code class="docutils literal highlight highlight-cpp"><span></span><span class="p">.</span><span class="n">exe</span></code>, but that is ordinarily
only done on the Windows © operating system.
On most other systems, the extension is used for people to sort out different
types of files, but the operating system doesn’t need them to figure things out.</p>
<p>If our <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">main</span><span class="p">.</span><span class="n">cpp</span></code> contained syntax from the C++11 standard,
or included any headers that did, then in order for it to compile,
the following switch must also be added:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">++</span> <span class="n">main</span><span class="p">.</span><span class="n">cpp</span> <span class="o">-</span><span class="n">std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span>
</pre></div>
</div>
<p>The default C++ version for most compilers, gcc included is c++98.</p>
<p>A summary of useful command line arguments:</p>
<dl class="docutils">
<dt>o</dt>
<dd>Specify the output executable filename.</dd>
<dt>g</dt>
<dd><p class="first">Include debugging symbols in the executable output.
Debug level #2 is the default.</p>
<p class="last">You must include this if you want to debug your program using a debugger.</p>
</dd>
<dt>Wall</dt>
<dd>Print all warnings</dd>
<dt>Werror</dt>
<dd>Treat warnings as errors and do not write an executable output file.</dd>
<dt>Wextra</dt>
<dd>Print extra warnings above and beyond ‘all’.</dd>
<dt>pedantic</dt>
<dd>Warn about code not compliant with the ISO standard.</dd>
<dt>std=c++11</dt>
<dd>Instruct the compiler the program contains C++11 syntax.</dd>
<dt>O3</dt>
<dd>Compile with optimization level #3 enabled.</dd>
</dl>
<p>The order of command line arguments (generally) does not matter.</p>
</div>
<div class="section" id="the-make-utility">
<span id="index-2"></span><h2>The make utility<a class="headerlink" href="#the-make-utility" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> program automatically determines which pieces of a large
program need to be recompiled, and issues commands to recompile them.
Note how this is different from the previous sections.
The <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> program doesn’t actually compile anything.
It doesn’t know how.
What <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> <em>does know</em> is</p>
<ul class="simple">
<li>What source files are normally associated with C++ programs</li>
<li>What commands are used to compile and link C++ source files</li>
</ul>
<p><code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> actually ‘knows’ some other things as well,
and can be given more information to make it even more useful,
but these first two things are the most important.</p>
<p>To prepare to use ‘make’, you must write a file called the “makefile”
that describes the relationships among files in your program and
provides commands for updating each file.
By default, <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> searches for a file named <strong>Makefile</strong>.</p>
<p>Once a file named Makefile exists, each time you change some source
files, this simple shell command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span>
</pre></div>
</div>
<p>is enough to perform all necessary recompilations.  The <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> program
uses the makefile data and the last-modification times of the files
to decide which of the files need to be updated.  For each of those
files, it issues the recipes recorded in the makefile.</p>
<p>A simple makefile consists of “rules” with the following shape:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TARGET</span> <span class="p">...</span> <span class="o">:</span> <span class="n">PREREQUISITES</span> <span class="p">...</span>
   <span class="n">RECIPE</span>
   <span class="p">...</span>
   <span class="p">...</span>
</pre></div>
</div>
<p>A “target” is usually the name of a file that is generated by a
program; examples of targets are executable or object files.  A target
can also be the name of an action to carry out, such as ‘clean’.
Since these don’t result in object files or executables, they are called
<em>phony targets</em>.</p>
<p>A “prerequisite” is a file that is used as input to create the
target.  A target often depends on several files.</p>
<p>A “recipe” is an action that ‘make’ carries out.  A recipe may have
more than one command, either on the same line or each on its own line.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to put a tab character at the beginning of every
recipe line!  This is an obscurity that catches the unwary.</p>
</div>
<p>A <em>very</em> simple Unix C++ makefile:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">CXX</span> <span class="o">=</span> c++
<span class="nv">CXXFLAGS</span><span class="o">=</span>-Wall -Wextra -pedantic -std<span class="o">=</span>c++11 -O3

<span class="nf">my_prog </span><span class="o">:</span> <span class="n">clean</span>
   <span class="si">${</span><span class="nv">CXX</span><span class="si">}</span> <span class="si">${</span><span class="nv">CXXFLAGS</span><span class="si">}</span> -o my_prog *.cpp

<span class="nf">clean</span><span class="o">:</span>
   rm -f my_prog
</pre></div>
</div>
<p>This makefile always deletes the executable file ‘my_prog’
whether any source files have changed or not and recompiles
every cpp file in the current directory to regenerate the executable.
Not particularly efficient, but for small programs
it gets the job done and requires no maintenance if new files are added.</p>
<p>Assuming you keep your work separated into directories so that
all the source code in a directory applies only to a single executable,
then this simple makefile is sufficient for everything you’ll
need to worry about over course duration.</p>
<p>Suffice it to say that make provides many tools and techniques to define
‘smarter’ recipes that do not suffer the constraints listed above.</p>
<p>The make program defines a large number of built-in variables to control
how programs get built.
While there are many,
the two to focus on for now are those used in the previous makefile.</p>
<blockquote>
<div><dl class="docutils">
<dt>CXX</dt>
<dd>Specify which C++ compiler to use</dd>
<dt>CXXFLAGS</dt>
<dd>Specify command line arguments to pass to the C++ compiler</dd>
</dl>
</div></blockquote>
<p>A slight variation on this theme creates several executables from a list.
The primary assumption in this makefile is that each program in the list <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">PROGS</span></code>
contains a main and is a single file.
The makefile makes use of the fact that <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> can make a simple program
without a makefile, if the program is contained within a single file.</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">CXX</span> <span class="o">=</span> c++
<span class="nv">CXXFLAGS</span><span class="o">=</span>-Wall -Wextra -pedantic -std<span class="o">=</span>c++11 -O3

<span class="nv">PROGS</span> <span class="o">=</span> asciitable <span class="se">\</span>
        hello <span class="se">\</span>
        phrase-o-matic <span class="se">\</span>
        printodds <span class="se">\</span>
        std11-test <span class="se">\</span>

<span class="nf">all</span><span class="o">:</span> <span class="k">$(</span><span class="nv">PROGS</span><span class="k">)</span>

<span class="nf">clean</span><span class="o">:</span>
    rm -f <span class="k">$(</span>PROGS<span class="k">)</span>
</pre></div>
</div>
<p>Even without a Makefile, <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">make</span></code> is smart enough to produce sensible
defaults for simple programs.
For example, given our <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">main</span><span class="p">.</span><span class="n">cpp</span></code> example from the previous section,
we can make it using make:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">main</span>
</pre></div>
</div>
<p>The make program will actually invoke:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">++</span> <span class="n">main</span><span class="p">.</span><span class="n">cpp</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span>
</pre></div>
</div>
<p>If you have exported an environment variable that make uses,
such as <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">CXXFLAGS</span></code>, then those will be used by make:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">export</span> <span class="n">CXXFLAGS</span><span class="o">=-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Wextra</span> <span class="o">-</span><span class="n">pedantic</span> <span class="o">-</span><span class="n">std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span>
</pre></div>
</div>
<p>Now the make program will invoke:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">main</span>
<span class="n">g</span><span class="o">++</span> <span class="n">main</span><span class="p">.</span><span class="n">cpp</span> <span class="o">-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Wextra</span> <span class="o">-</span><span class="n">pedantic</span> <span class="o">-</span><span class="n">std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span>
</pre></div>
</div>
<p>Which is exactly what the previous makefile is doing, but on all of the
programs listed.</p>
</div>
<div class="section" id="running-your-programs">
<h2>Running your programs<a class="headerlink" href="#running-your-programs" title="Permalink to this headline">¶</a></h2>
<p>If you compile your own program, you will need to prefix it with ./
on the command line to tell the shell that you want to run a program
in the current directory (called ‘.’) instead of one of the standard system directories.
So for example, if I’ve just built a program called <em>hello</em>, I can run it by typing:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">hello</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="admonition-more-to-explore admonition">
<p class="first admonition-title">More to Explore</p>
<ul class="last simple">
<li>Textbook FAQ: <a class="reference internal" href="../q101-why-not-an-ide.html"><span class="doc">Why not use an IDE?</span></a></li>
<li><a class="reference external" href="https://www.gnu.org/software/make/manual/">GNU Make Manual</a></li>
<li>Prefer compile-time and link-time errors to runtime errors<ul>
<li>Effective C++ item #46</li>
</ul>
</li>
<li>Pay attention to compiler warnings<ul>
<li>Effective C++ item #48</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - Introducing the vim editor' data-toggle="tooltip">
    <a href="vim.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="vim.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - Version control' data-toggle="tooltip" >
    <a href="version-control.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="version-control.html" >Next Section - Version control</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017-2018 Dave Parillo.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> 3.4.6.dev0.
    </p>
  </div>
</footer>



  </body>
</html>