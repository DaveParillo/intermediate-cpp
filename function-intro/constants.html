<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3.2. Keyword: const &#8212; Intermediate Modern C++ Overview</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../_static/clickable.css?v=58C4E18A" />
    <link rel="stylesheet" type="text/css" href="../_static/tabbedstuff.css?v=424F1CC9" />
    <link rel="stylesheet" type="text/css" href="../_static/fitb.css?v=3BA0E63E" />
    <link rel="stylesheet" type="text/css" href="../_static/video.css?v=-1AC7A4C5" />
    <link rel="stylesheet" type="text/css" href="../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../_static/webglinteractive.css?v=-6EF20E1F" />
    <link rel="stylesheet" type="text/css" href="../_static/codemirror.css?v=1CE53237" />
    <link rel="stylesheet" type="text/css" href="../_static/reveal.css?v=4A81D381" />
    <link rel="stylesheet" type="text/css" href="../_static/parsons.css?v=2F3E13EE" />
    <link rel="stylesheet" type="text/css" href="../_static/js_lib/prettify.css?v=2A364B6B" />
    <link rel="stylesheet" type="text/css" href="../_static/pytutor.css?v=239FC54E" />
    <link rel="stylesheet" type="text/css" href="../_static/modal-basic.css?v=-75E5BD1C" />
    <link rel="stylesheet" type="text/css" href="../_static/activecode.css?v=-B8E06A5" />
    <link rel="stylesheet" type="text/css" href="../_static/datafile.css?v=-3E7B1476" />
    <link rel="stylesheet" type="text/css" href="../_static/showEval.css?v=C6382F3" />
    <link rel="stylesheet" type="text/css" href="../_static/accessibility.css?v=-7F7467D6" />
    <link rel="stylesheet" type="text/css" href="../_static/dragndrop.css?v=-46455F2F" />
    <link rel="stylesheet" type="text/css" href="../_static/poll.css?v=-1DDF53CD" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/runestonebase.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/matrixeq.js?v=-29B305A6"></script>
    <script type="text/javascript" src="../_static/clickable.js?v=-6A9F19A2"></script>
    <script type="text/javascript" src="../_static/timedclickable.js?v=-6C6763DD"></script>
    <script type="text/javascript" src="../_static/tabbedstuff.js?v=5BE6106"></script>
    <script type="text/javascript" src="../_static/fitb.js?v=-71BF18ED"></script>
    <script type="text/javascript" src="../_static/timedfitb.js?v=2AA17071"></script>
    <script type="text/javascript" src="../_static/runestonevideo.js?v=53E888DE"></script>
    <script type="text/javascript" src="../_static/codemirror.js?v=-6B0AAD37"></script>
    <script type="text/javascript" src="../_static/xml.js?v=236EDFF7"></script>
    <script type="text/javascript" src="../_static/css.js?v=623153CE"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js?v=33B91944"></script>
    <script type="text/javascript" src="../_static/javascript.js?v=6F38CA04"></script>
    <script type="text/javascript" src="../_static/webglinteractive.js?v=2B768384"></script>
    <script type="text/javascript" src="../_static/FileSaver.min.js?v=-7BF73669"></script>
    <script type="text/javascript" src="../_static/Blob.js?v=AEC2447"></script>
    <script type="text/javascript" src="../_static/reveal.js?v=112CBFA2"></script>
    <script type="text/javascript" src="../_static/js_lib/prettify.js?v=-358176D8"></script>
    <script type="text/javascript" src="../_static/js_lib/hammer.min.js?v=73056367"></script>
    <script type="text/javascript" src="../_static/parsons.js?v=-6C1000C7"></script>
    <script type="text/javascript" src="../_static/timedparsons.js?v=2EEA9E5A"></script>
    <script type="text/javascript" src="../_static/animationbase.js?v=-5FBC3C59"></script>
    <script type="text/javascript" src="../_static/mchoice.js?v=6E285D06"></script>
    <script type="text/javascript" src="../_static/timedmc.js?v=-4FEF5BA9"></script>
    <script type="text/javascript" src="../_static/timed.js?v=6789FE30"></script>
    <script type="text/javascript" src="../_static/shortanswer.js?v=-44F4664F"></script>
    <script type="text/javascript" src="../_static/timed_shortanswer.js?v=-4C5EE829"></script>
    <script type="text/javascript" src="../_static/d3.v2.min.js?v=836E01C"></script>
    <script type="text/javascript" src="../_static/jquery.ba-bbq.min.js?v=-49B30F58"></script>
    <script type="text/javascript" src="../_static/jquery.jsPlumb-1.3.10-all-min.js?v=42F9EBEA"></script>
    <script type="text/javascript" src="../_static/pytutor.js?v=-7D4FDD47"></script>
    <script type="text/javascript" src="../_static/codelens.js?v=-354132B7"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js?v=-E3B6938"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js?v=-57645C8C"></script>
    <script type="text/javascript" src="../_static/python.js?v=14A28F1F"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/CLDRPluralRuleParser.js?v=599B42B0"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.js?v=-775EBCF1"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.messagestore.js?v=-51EA5B5F"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.fallbacks.js?v=-75420181"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.language.js?v=747279FF"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.parser.js?v=7B020E13"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.emitter.js?v=660E85C3"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.emitter.bidi.js?v=54B21948"></script>
    <script type="text/javascript" src="../_static/activecode-i18n.en.js?v=-6D577C35"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js?v=75F941D8"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js?v=-4AE6ECF7"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@4.0.0-rc.2/build/vega.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@2.5.0/build/vega-lite.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@3.14.0/build/vega-embed.js"></script>
    <script type="text/javascript" src="../_static/activecode.js?v=-F502D84"></script>
    <script type="text/javascript" src="../_static/clike.js?v=2DCE0756"></script>
    <script type="text/javascript" src="../_static/timed_activecode.js?v=5150FA78"></script>
    <script type="text/javascript" src="../_static/datafile.js?v=3ED1A80C"></script>
    <script type="text/javascript" src="../_static/showEval.js?v=-3A31F37F"></script>
    <script type="text/javascript" src="../_static/dragndrop.js?v=2B6403E8"></script>
    <script type="text/javascript" src="../_static/timeddnd.js?v=378F237E"></script>
    <script type="text/javascript" src="../_static/poll.js?v=6C59AE9F"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.3. Keyword: auto" href="auto.html" />
    <link rel="prev" title="3.1. Introduction to functions" href="functions.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/intermediate-cpp/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'https://daveparillo.github.io/intermediate-cpp/' ? 'https://daveparillo.github.io/intermediate-cpp/' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/intermediate-cpp';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'intermediate-cpp';
  eBookConfig.acDefaultLanguage = 'cpp' ? 'cpp' : 'cpp'
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = false;
  eBookConfig.basecourse = 'intermediate-cpp';
  eBookConfig.jobehost = 'https://fierce-ridge-58946.herokuapp.com/http://jobe2.cosc.canterbury.ac.nz';
  eBookConfig.proxyuri_runs = '/jobe/index.php/restapi/runs/';
  eBookConfig.proxyuri_files = '/jobe/index.php/restapi/files/';
  eBookConfig.runestone_version = '3.4.6.dev0';
</script>


  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='padding:12px 0;text-align:center' href="http://209.129.16.61/~dparillo/">
           <i class="glyphicon glyphicon-home" style='opacity:0.9;font-size:16px;color:#848484'></i>
        </a>
        <!--
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/intermediate-cpp/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="/~dparillo" style="color:#5080a0">CISC-187</a>&nbsp;
        -->
        <a class="navbar-brand" href="../index.html">Intermediate C++</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='https://daveparillo.github.io/intermediate-cpp//genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='https://daveparillo.github.io/intermediate-cpp//help/navhelp.html'>Navigation Help</a></li>
            <li><a href='https://daveparillo.github.io/intermediate-cpp//glossary.html'>Glossary</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">3.2. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code></a><ul>
<li><a class="reference internal" href="#prefer-const-to-define">3.2.1. Prefer <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> to <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code></a><ul>
<li><a class="reference internal" href="#function-like-macros-using-define">3.2.1.1. Function-like macros using <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#keyword-constexpr">3.2.2. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code></a></li>
<li><a class="reference internal" href="#guidelines-for-now">3.2.3. Guidelines for now</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 3.1. Introduction to functions" data-toggle="tooltip">
    <a href="functions.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 3.3. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">auto</span></code>' data-toggle="tooltip" >
    <a href="auto.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="keyword-const">
<span id="index-0"></span><h1>3.2. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code><a class="headerlink" href="#keyword-const" title="Permalink to this headline">¶</a></h1>
<p>Use <a class="reference external" href="http://en.cppreference.com/mwiki/index.php?search=const">const</a> to instruct the compiler to hold something constant.
The <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> keyword can modify the behavior of anything, depending on where it is used:</p>
<ul class="simple">
<li>fundamental types</li>
<li>structs or classes</li>
<li>functions and function parameters</li>
<li>pointers and references<ul>
<li>or the values stored in pointers and references</li>
</ul>
</li>
</ul>
<p>Programs typically use a lot of constants.
Mathematical constants like <span class="math notranslate nohighlight">\(\pi\)</span>, or <span class="math notranslate nohighlight">\(e\)</span>, and unit conversions are common.
Obviously, it would be bad if a program changed the value of <span class="math notranslate nohighlight">\(\pi\)</span> in the middle
of its execution.
As programmers, we can make a promise to never change those variables that should
not change.
But the language allows a way to enforce the idea.</p>
<p>A <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> is a named constant.
It can’t be assigned a new value after initialization.
For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">double</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.14159265359</span><span class="p">;</span>

<span class="kt">double</span> <span class="n">area</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">r</span><span class="p">;</span>           <span class="c1">// OK to read pi like any other variable</span>

<span class="n">pi</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>                             <span class="c1">// this is a compile error</span>
</pre></div>
</div>
<p id="index-1">Returning to our by_reference function from the previous section,
we have seen that pass by reference makes passing data to functions cheap:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">by_reference</span> <span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;in by_ref the address of x is   &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>But one of the side-effects of making passing cheap,
is that now the called function might change the value provided.
As programmers, we could promise to not change values in functions that shouldn’t,
but generally, we don’t like promises.
Programmers prefer contracts.
Fortunately, <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> allows us to define just such a contract in the declaration:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">by_reference</span> <span class="p">(</span><span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;in by_ref the address of x is   &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>  <span class="c1">// this is now a compile error</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is called <strong>passing by constant reference</strong>, or “const ref”, for short.
Passing by const ref allows us to enforce our intentions.
If a variable is declared as <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code>, it is a compile error to change it.
Any callers can use this function and rest assured that their data cannot change.
The more time you spend programming,
the more you will appreciate how powerful that guarantee is.</p>
<p>C99 added the <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> keyword, so now it’s in both languages,
but you don’t see it nearly as often in C.
Many programmers use <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> instead.</p>
<div class="section" id="prefer-const-to-define">
<span id="index-2"></span><h2>3.2.1. Prefer <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> to <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code><a class="headerlink" href="#prefer-const-to-define" title="Permalink to this headline">¶</a></h2>
<p>We also prefer <a class="reference external" href="http://en.cppreference.com/mwiki/index.php?search=inline specifier">inline specifier</a> and <a class="reference external" href="http://en.cppreference.com/mwiki/index.php?search=enum declaration">enum declaration</a> over
<a class="reference external" href="http://en.cppreference.com/mwiki/index.php?search=define">define</a>.</p>
<p>There are good reasons to avoid <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> where alternatives exist.</p>
<p><code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> is parsed by the <em>preprocessor</em>, not the compiler.
This mean that effectively, all <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> directives are literally strings.
Fundamentally they are no different from any other pre-processor directive (<code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#include</span></code>, <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#ifdef</span></code>, etc.),
except that people commonly use <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> as a placeholder for a numeric <a class="reference internal" href="../glossary.html#term-type"><span class="xref std std-term">type</span></a>,
or a function.</p>
<p>For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#define ASPECT_RATIO 1.653</span>
</pre></div>
</div>
<p>is an old fashioned way to define a constant, but you’ll likely see it ‘in the wild’.
The pre-processor literally copies the value ‘1.653’ every place in the source code
it encounters the string ‘ASPECT_RATIO’.
Then the program is compiled.</p>
<p>Prefer this instead:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">double</span> <span class="n">ASPECT_RATIO</span> <span class="o">=</span> <span class="mf">1.653</span><span class="p">;</span>
</pre></div>
</div>
<p>This version preserves the name ‘ASPECT_RATIO’ which can simplify debugging.
It is possible to also preserve macro names using
certain debugging compiler switches, such as <code class="docutils literal highlight highlight-cpp"><span></span><span class="o">-</span><span class="n">g3</span></code>.</p>
<div class="section" id="function-like-macros-using-define">
<span id="index-3"></span><h3>3.2.1.1. Function-like macros using <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code><a class="headerlink" href="#function-like-macros-using-define" title="Permalink to this headline">¶</a></h3>
<p>If you use <code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> to create a function-like macro, then unexpected behaviors are possible.
For example,
a macro to call some function <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">f</span><span class="p">()</span></code> with the larger of either <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">a</span></code> or <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">b</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="cp">#define CALL_WITH_MAX(a,b) f((a) &gt; (b) ? (a) : (b))</span>

<span class="kt">int</span> <span class="nf">f</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
  <span class="k">const</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CALL_WITH_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>                  <span class="c1">// call f, but throw away the result</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, a: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="c1">// a is one larger each iteration</span>
  <span class="p">}</span>

  <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CALL_WITH_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, a: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The number of times <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">a</span></code> is incremented depends on <strong>how</strong> <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">CALL_WITH_MAX</span></code> is called.
In this case, the value of <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">b</span></code> affects whether <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">a</span></code> is incremented once or twice.
<strong>Ouch!</strong></p>
<p>Step through <a class="reference external" href="http://pythontutor.com/cpp.html#code=%23include%20%3Ciostream%3E%0A%23define%20CALL_WITH_MAX%28a,b%29%20f%28%28a%29%20%3E%20%28b%29%20%3F%20%28a%29%20%3A%20%28b%29%29%0A%0Aint%20f%28const%20int%20x%29%20%7B%0A%20%20return%20x%3B%0A%7D%0Aint%20main%28%29%20%7B%0A%20%20int%20a%20%3D%20-5%3B%20%0A%20%20const%20int%20b%20%3D%200%3B%0A%0A%20%20for%20%28int%20i%20%3D%201%3B%20i%20%3C%2011%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20CALL_WITH_MAX%28%2B%2Ba,%20b%29%3B%0A%20%20%20%20std%3A%3Acout%20%3C%3C%20i%20%3C%3C%20%22,%20a%3A%20%22%20%3C%3C%20a%20%3C%3C%20'%5Cn'%3B%0A%20%20%7D%0A%20%20a%20%3D%20-5%3B%20%0A%20%20for%20%28int%20i%20%3D%201%3B%20i%20%3C%2011%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20CALL_WITH_MAX%28%2B%2Ba,%20b%2B10%29%3B%0A%20%20%20%20std%3A%3Acout%20%3C%3C%20i%20%3C%3C%20%22,%20a%3A%20%22%20%3C%3C%20a%20%3C%3C%20'%5Cn'%3B%0A%20%20%7D%0A%7D&amp;curInstr=63&amp;mode=display&amp;origin=opt-frontend.js&amp;py=cpp&amp;rawInputLstJSON=%5B%5D">example 17</a> and see for yourself.</p>
<p><code class="docutils literal highlight highlight-cpp"><span></span><span class="cp">#define</span></code> may seem like a shortcut.
It’s not.</p>
<p>Use it when no better alternative exists.</p>
</div>
</div>
<div class="section" id="keyword-constexpr">
<span id="index-4"></span><h2>3.2.2. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code><a class="headerlink" href="#keyword-constexpr" title="Permalink to this headline">¶</a></h2>
<p>The keyword <a class="reference external" href="http://en.cppreference.com/mwiki/index.php?search=constexpr">constexpr</a> was added in C++11.</p>
<p>The fundamental difference between <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> and <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code> is that
<code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code> must be able to be determined at compile time.
So while this is OK:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">constexpr</span> <span class="kt">double</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.14159265359</span><span class="p">;</span>

<span class="c1">// and so is this</span>
<span class="k">constexpr</span> <span class="kt">double</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// and so is this</span>
<span class="k">constexpr</span> <span class="kt">double</span> <span class="nf">area</span> <span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">radius</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is not OK in C++11:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">constexpr</span> <span class="kt">double</span> <span class="nf">area</span> <span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">radius</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">assert</span> <span class="p">(</span><span class="n">radius</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Adding a simple assertion causes this function to no longer compile:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>g++ -std=c++11 -Wall -Wextra -pedantic     area.cpp   -o area
area.cpp: In function ‘constexpr double area(double)’:
area.cpp:8:1: error: body of constexpr function ‘constexpr double area(double)’ not a return-statement
  }
  ^
</pre></div>
</div>
<p>On compilers that support C++14, if you compile with <code class="docutils literal highlight highlight-cpp"><span></span><span class="o">-</span><span class="n">std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span></code> you may see a warning like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>warning: use of this statement in a constexpr function is a C++14 extension [-Wc++14-extensions]
  assert (radius &gt; 0);
</pre></div>
</div>
<p>There are some exceptions, but in C++11,
any function more complex than <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">return</span> <span class="p">(</span><span class="n">some_expression</span><span class="p">)</span></code>
is not able to be evaluated at compile time,
therefore, it won’t compile as a <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code> expression.
You should still use it when you can.</p>
<p>The rules for <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code> changed in C++14 and more in C++17.
Although not available on the Mesa server, you should still
<a class="reference external" href="http://en.cppreference.com/w/cpp/language/constexpr">read the docs</a>
and be aware of what is and is not a valid constant expression
for whatever environment you are working in.</p>
</div>
<div class="section" id="guidelines-for-now">
<span id="index-5"></span><h2>3.2.3. Guidelines for now<a class="headerlink" href="#guidelines-for-now" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>When creating local variables<ul>
<li>Ask: “Does this variable ever change?”</li>
<li>If not, consider <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> or <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code></li>
</ul>
</li>
<li>Recall <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">constexpr</span></code> is more restrictive<ul>
<li>Constant expression is evaluated at <em>compile time</em></li>
</ul>
</li>
<li>When passing parameters to functions<ul>
<li>Consider passing by <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> reference<ul>
<li>Applies only to object types<ul>
<li>Pass fundamental types by <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">const</span></code> value if they should not change</li>
</ul>
</li>
<li>Avoids making an extra (unneeded) copy</li>
<li>Prevents unintended modification</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition-try-this admonition">
<p class="first admonition-title">Try This!</p>
<p>Given the following:</p>
<p>How many simple changes can you make to the function <code class="docutils literal highlight highlight-cpp"><span></span><span class="n">area</span></code> that are valid
if the function signature is</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">double</span> <span class="n">area</span> <span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">but invalid if the function signature is unchanged?</p>
</div>
<hr class="docutils" />
<div class="admonition-more-to-explore admonition">
<p class="first admonition-title">More to Explore</p>
<ul class="last simple">
<li>From: cppreference.com:
<a class="reference external" href="http://en.cppreference.com/w/cpp/language/cv">const qualifier</a> and
<a class="reference external" href="http://en.cppreference.com/w/cpp/language/constant_expression">constexpr</a></li>
<li><a class="reference external" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rconst-constexpr">C++ Core Guidelines for constexpr</a>
from GitHub</li>
</ul>
</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 3.1. Introduction to functions' data-toggle="tooltip">
    <a href="functions.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="functions.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 3.3. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">auto</span></code>' data-toggle="tooltip" >
    <a href="auto.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="auto.html" >Next Section - 3.3. Keyword: <code class="docutils literal highlight highlight-cpp"><span></span><span class="k">auto</span></code></a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017-2018 Dave Parillo.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> 3.4.6.dev0.
    </p>
  </div>
</footer>



  </body>
</html>