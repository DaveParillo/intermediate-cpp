<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>13.4. Inheritance &#8212; Intermediate Modern C++ Overview</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/matrixeq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="../_static/webgldemo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/webglinteractive.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/js_lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="../_static/showEval.css" type="text/css" />
    <link rel="stylesheet" href="../_static/accessibility.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/runestonebase.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/matrixeq.js"></script>
    <script type="text/javascript" src="../_static/clickable.js"></script>
    <script type="text/javascript" src="../_static/timedclickable.js"></script>
    <script type="text/javascript" src="../_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="../_static/fitb.js"></script>
    <script type="text/javascript" src="../_static/timedfitb.js"></script>
    <script type="text/javascript" src="../_static/runestonevideo.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/xml.js"></script>
    <script type="text/javascript" src="../_static/css.js"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/webglinteractive.js"></script>
    <script type="text/javascript" src="../_static/FileSaver.min.js"></script>
    <script type="text/javascript" src="../_static/Blob.js"></script>
    <script type="text/javascript" src="../_static/reveal.js"></script>
    <script type="text/javascript" src="../_static/js_lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/js_lib/hammer.min.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/timedparsons.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/mchoice.js"></script>
    <script type="text/javascript" src="../_static/timedmc.js"></script>
    <script type="text/javascript" src="../_static/timed.js"></script>
    <script type="text/javascript" src="../_static/shortanswer.js"></script>
    <script type="text/javascript" src="../_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="../_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/pytutor.js"></script>
    <script type="text/javascript" src="../_static/codelens.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/CLDRPluralRuleParser.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.messagestore.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.fallbacks.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.language.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.parser.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.emitter.js"></script>
    <script type="text/javascript" src="../_static/jquery_i18n/jquery.i18n.emitter.bidi.js"></script>
    <script type="text/javascript" src="../_static/activecode-i18n.en.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@4.0.0-rc.2/build/vega.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@2.5.0/build/vega-lite.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@3.14.0/build/vega-embed.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/clike.js"></script>
    <script type="text/javascript" src="../_static/timed_activecode.js"></script>
    <script type="text/javascript" src="../_static/datafile.js"></script>
    <script type="text/javascript" src="../_static/showEval.js"></script>
    <script type="text/javascript" src="../_static/dragndrop.js"></script>
    <script type="text/javascript" src="../_static/timeddnd.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="14. Memory Management" href="../class-IV-memory/toctree.html" />
    <link rel="prev" title="13.3. Composition" href="composition.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/intermediate-cpp/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'https://daveparillo.github.io/intermediate-cpp/' ? 'https://daveparillo.github.io/intermediate-cpp/' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/intermediate-cpp';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'intermediate-cpp';
  eBookConfig.acDefaultLanguage = 'cpp' ? 'cpp' : 'cpp'
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = false;
  eBookConfig.basecourse = 'intermediate-cpp';
  eBookConfig.jobehost = 'https://fierce-ridge-58946.herokuapp.com/http://jobe2.cosc.canterbury.ac.nz';
  eBookConfig.proxyuri_runs = '/jobe/index.php/restapi/runs/';
  eBookConfig.proxyuri_files = '/jobe/index.php/restapi/files/';
  eBookConfig.runestone_version = '3.2.6';
</script>


  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='padding:12px 0;text-align:center' href="http://209.129.16.61/~dparillo/">
           <i class="glyphicon glyphicon-home" style='opacity:0.9;font-size:16px;color:#848484'></i>
        </a>
        <!--
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/intermediate-cpp/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="/~dparillo" style="color:#5080a0">CISC-187</a>&nbsp;
        -->
        <a class="navbar-brand" href="../index.html">Intermediate C++</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='https://daveparillo.github.io/intermediate-cpp//genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='https://daveparillo.github.io/intermediate-cpp//help/navhelp.html'>Navigation Help</a></li>
            <li><a href='https://daveparillo.github.io/intermediate-cpp//glossary.html'>Glossary</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">13.4. Inheritance</a><ul>
<li><a class="reference internal" href="#when-to-use-inheritance">13.4.1. When to use inheritance</a></li>
<li><a class="reference internal" href="#private-inheritance">13.4.2. Private inheritance</a></li>
<li><a class="reference internal" href="#non-virtual-base-class-functions">13.4.3. Non-virtual base class functions</a></li>
<li><a class="reference internal" href="#multiple-inheritance">13.4.4. Multiple inheritance</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 13.3. Composition" data-toggle="tooltip">
    <a href="composition.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 14. Memory Management' data-toggle="tooltip" >
    <a href="../class-IV-memory/toctree.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="inheritance">
<span id="index-0"></span><h1>13.4. Inheritance<a class="headerlink" href="#inheritance" title="Permalink to this headline">¶</a></h1>
<p>Inheritance enables new classes to receive — or inherit —
the properties and methods of existing classes.
Inheritance is a programming strategy used to increase the flexibility
of your objects.
In particular, inheritance is <strong>not</strong> a code reuse strategy.
The purpose of inheritance in C++ is to express interface compliance
(creating a subtype), not to reuse code.
In C++, code reuse usually comes via composition rather than
via inheritance.
In other words,
inheritance is mainly a specification technique rather than an
implementation technique.</p>
<p>New programmers are generally eager to “do things the OO way”
and tend to overuse inheritance relationships.
This is especially true if starting with UML diagrams:
many diagram look ‘too simple’ without a lot of boxes
connected by generalization relations.</p>
<div class="admonition-guideline admonition">
<p class="first admonition-title">Guideline</p>
<p class="last">Prefer composition over inheritance.</p>
</div>
<p>Consider the following classes.</p>
<img src="../_images/graphviz-fdfdb21d3a133faec6227a690209098ae7abcb5c.png" alt="Person inheritance" />

    <div data-component="reveal" id="r_class_inherit"   data-showtitle="Is this OK?" data-hidetitle="Hide">
    <p>No.</p>
<p>We have asserted that a penguin can fly.</p>
<p>We might choose to implement <code class="docutils literal notranslate"><span class="pre">fly()</span></code> in our penguin class
and simply do nothing,
but generally when we do that we are coing our way around a
basic design problem.</p>

    </div>
    <p>It is very important when creating a class hierarchy using
inheritance that <em>every</em> derived class passes the <strong>is a</strong> test
for <strong>all</strong> of its bases.
For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nl">oven</span><span class="p">:</span> <span class="k">public</span> <span class="n">kitchen</span> <span class="p">{</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">};</span>
</pre></div>
</div>
<p>This is not a proper relationship.
An oven is a thing commonly <em>found</em> in a kitchen,
but that does not mean an oven <em>is a</em> kitchen.
Because it fails this basic test,
it is likely that variables and functions that apply to the base:
<code class="docutils literal notranslate"><span class="pre">cupboards</span></code>, <code class="docutils literal notranslate"><span class="pre">sink</span></code>, <code class="docutils literal notranslate"><span class="pre">enter_room()</span></code>, etc
will fail to make sense when applied to the derived class.</p>
<p>This is an example better modelled through composition.
A kitchen <strong>has a</strong> sink in it.</p>
<div class="section" id="when-to-use-inheritance">
<h2>13.4.1. When to use inheritance<a class="headerlink" href="#when-to-use-inheritance" title="Permalink to this headline">¶</a></h2>
<p>Adapted from <em>Composition vs. Inheritance: How to Choose?</em>.</p>
<p>The most common — and beneficial — use of inheritance is to
incrementally extend types.
If we need a widget that is just like an existing Widget class,
but with a few tweaks and enhancements,
then inheritance is suitable.
Inheritance is the right choice because our derived class is still a widget.
We want to reuse the entire interface and implementation from the base class
and our changes are primarily <strong>additive</strong>.
That is, the derived class adds capabilities to base.
If you find that a derived class is removing things provided by the base class,
then question inheriting from that base.</p>
<p>Inheritance is most useful for grouping related sets of concepts,
identifying families of classes,
and in general organizing the names and concepts that describe the domain.
As we delve deeper into the implementation of a system,
we may find that our original generalizations about the domain concepts,
captured in our inheritance hierarchies,
are incorrect.
Don’t be afraid to disassemble inheritance hierarchies into sets of
complementary cooperating interfaces and components
when the code leads you in that direction.</p>
<p>There is no substitute for object modeling and critical design thinking.
But if you must have some guidelines, consider these.</p>
<p>Inheritance should only be used when:</p>
<ul class="simple">
<li>Both classes are in the same logical domain</li>
<li>The derived class is a proper subtype of the base class: think <strong>is a</strong></li>
<li>The base class implementation is necessary or appropriate for the derived class</li>
<li>The enhancements made by the derived class are primarily additive</li>
</ul>
</div>
<div class="section" id="private-inheritance">
<span id="index-1"></span><h2>13.4.2. Private inheritance<a class="headerlink" href="#private-inheritance" title="Permalink to this headline">¶</a></h2>
<p>The default inheritiance model in C++ is <em>priavte inheritance</em>.
In private inheritance <strong>all</strong> of the base class members:
data and functions, public, protected, and private,
are treated as <strong>private members</strong> of the derived class.</p>
<p>A common question is “Why would we ever do this?”</p>
<p>If a derived class wants to reuse all of the code from a base class,
but <em>not</em> conform to the interface,
then private inheritance is how to achieve that.</p>
</div>
<div class="section" id="non-virtual-base-class-functions">
<span id="index-2"></span><h2>13.4.3. Non-virtual base class functions<a class="headerlink" href="#non-virtual-base-class-functions" title="Permalink to this headline">¶</a></h2>
<p>Every non-virtual base class function defines a
<strong>mandatory interface</strong> for all derived classes.
The language allows a derived class to implement its own version.
For example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">B</span> <span class="p">{</span>
  <span class="kt">void</span> <span class="n">foo</span><span class="p">();</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nl">D</span><span class="p">:</span> <span class="k">public</span> <span class="n">B</span> <span class="p">{</span>
  <span class="kt">void</span> <span class="n">foo</span><span class="p">();</span>        <span class="c1">// derived class D has its own version</span>
<span class="p">};</span>
</pre></div>
</div>
<p>If class <code class="docutils literal notranslate"><span class="pre">D</span></code> implements its own version of <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
then this is <strong>not</strong> an <code class="docutils literal notranslate"><span class="pre">override</span></code>.
This is called <em>shadowing</em> and is often a bug.</p>
<p>The problem is this:</p>
<ul>
<li><p class="first">An instance of <code class="docutils literal notranslate"><span class="pre">B</span></code> will always call <code class="docutils literal notranslate"><span class="pre">B::foo()</span></code></p>
</li>
<li><p class="first">An instance of <code class="docutils literal notranslate"><span class="pre">D</span></code> will always call <code class="docutils literal notranslate"><span class="pre">D::foo()</span></code></p>
</li>
<li><p class="first">An instance of <code class="docutils literal notranslate"><span class="pre">D</span></code> in a container of pointers to <code class="docutils literal notranslate"><span class="pre">B</span></code>
will call <code class="docutils literal notranslate"><span class="pre">B::foo()</span></code>.</p>
<p>New programmers are often caught off guard by this behavior.</p>
<p>Most modern compilers will warn about this.</p>
</li>
</ul>
<p>Even if the programmer is careful to ensure the contract defined
by <code class="docutils literal notranslate"><span class="pre">B::foo()</span></code> is also met by struct D,
there is no guarantee this can’t change in the future.
There is no way to know what else may depend on the contract
defined by <code class="docutils literal notranslate"><span class="pre">B::foo</span></code> or any if its invariants.</p>
<p>In general, if a derived class can’t use the existing mandatory
interface defined by a base class,
then it probably shouldn’t be a derived class.</p>
</div>
<div class="section" id="multiple-inheritance">
<span id="index-3"></span><h2>13.4.4. Multiple inheritance<a class="headerlink" href="#multiple-inheritance" title="Permalink to this headline">¶</a></h2>
<p>C++ allows for a single class to inherit capabilities from more than 1 class.
The constructors of inherited classes are called in the same order
in which they are inherited.
For example, in the following program,
B’s constructor is called before A’s constructor.</p>

<div data-childcomponent="ac_mult_inherit_ex1" class="runestone explainer ac_section alert alert-warning">

<textarea data-component="activecode" id=ac_mult_inherit_ex1 data-lang="cpp" 
      data-timelimit=25000    
    data-audio=''   
    data-compileargs="['-Wall', '-Wextra', '-pedantic', '-std=c++11']"      >
#include<iostream>
using std::cout;

struct A {
  A() { cout << "construct A\n"; }
};

struct B {
  B() { cout << "construct B\n"; }
};

struct C: public B, public A {     // Note the order
  C() { cout << "construct C\n"; }
};

int main() {
  C c;
}
</textarea>
</div>
<p>The destructors are called in reverse order of constructors.</p>
<p><strong>The Diamond of Death</strong></p>
<p>Since C++ allows multiple inheritance,
the following relationships are valid:</p>
<img src="../_images/graphviz-27407428f4bfdb9e5c000faba20a9584dab18aeb.png" alt="multiple inheritance" />
<p>The <code class="docutils literal notranslate"><span class="pre">TeachingAssistant</span></code> class is both a <code class="docutils literal notranslate"><span class="pre">Teacher</span></code> and a <code class="docutils literal notranslate"><span class="pre">Student</span></code>
and inherits two copies of the <code class="docutils literal notranslate"><span class="pre">Person</span></code> base class data.
When a TA is created, the Person constructor is called <em>twice</em>.
Once for each copy of the Person stored.
This is both wasteful and creates ambiguities.</p>
<p>The C++ solution to this problem is to inherit <em>virtual base</em> classes.
For each distinct base class that is specified virtual,
the most derived object contains only one base class subobject of that type,
even if the class appears many times in the inheritance hierarchy
(as long as it is inherited virtual every time).
For example:</p>

<div data-childcomponent="ac_mult_inherit_ex2" class="runestone explainer ac_section alert alert-warning">

<textarea data-component="activecode" id=ac_mult_inherit_ex2 data-lang="cpp" 
      data-timelimit=25000    
    data-audio=''   
    data-compileargs="['-Wall', '-Wextra', '-pedantic', '-std=c++11']"      >
#include<iostream>
#include<string>
using std::cout;
using std::string;

struct Person {
    explicit
    Person(string n)  { cout << "Person(" << n << ") called\n";   }
    Person()          { cout << "Person() called\n";   }
};

struct Faculty : virtual public Person {
    explicit
    Faculty(string n) : Person(n)   {
       cout<<"Faculty(" << n << ") called\n";
    }
};

struct Student : virtual public Person {
    explicit
    Student(string n) : Person(n) {
        cout<<"Student(" << n << ") called\n";
    }
};

struct TeachingAssistant : public Faculty, public Student  {
    explicit
    TeachingAssistant(string n)
      : Faculty(n), Student(n)   {
        cout<<"TA(" << n << ") called\n";
    }
};

int main()  {
    TeachingAssistant ta("Alice");
}
</textarea>
</div>
<p>This solves the ‘multiple grandparent problem’ for the teaching assistant class,
but note that the <strong>default</strong> Person constructor is called.
If the name is stored in the Person class,
then we need to call the non-default constructor.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Person(string)</span></code> constructor can be explicitly called in the
<code class="docutils literal notranslate"><span class="pre">TeachingAssistant</span></code> initializer.
In order for <code class="docutils literal notranslate"><span class="pre">Faculty</span></code> and <code class="docutils literal notranslate"><span class="pre">Student</span></code> to initialize correctly,
the Person class must be constructed first:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">explicit</span>
    <span class="nf">TeachingAssistant</span><span class="p">(</span><span class="n">string</span> <span class="n">n</span><span class="p">)</span>
      <span class="o">:</span> <span class="n">Person</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">Faculty</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">Student</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>   <span class="p">{</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
<div class="admonition-try-this admonition">
<p class="first admonition-title">Try This!</p>
<p class="last">Change the TA signature in the previous active code example
to call the 1 argument Person constructor.</p>
</div>
<p>What about the situation where <code class="docutils literal notranslate"><span class="pre">Person</span></code> defines a virtual function,
which is overridden by <code class="docutils literal notranslate"><span class="pre">Faculty</span></code> and <code class="docutils literal notranslate"><span class="pre">Student</span></code>?</p>
<p>Which version of the function is invoked?</p>
<p>There is no way to know.
Technically, any version could be called.
The standard doesn’t specify anything in this situation
Most compilers will essentially bail and not call <strong>any</strong> of the functions.</p>
<p>The TA class can resolve the ambiguity by explicitly calling a specific
base class function.
The derived class must call the fully qualified name of the function
like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TeachingAssistant</span><span class="o">::</span><span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">weekday</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Faculty</span><span class="o">::</span><span class="n">foo</span><span class="p">();</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">Student</span><span class="o">::</span><span class="n">foo</span><span class="p">();</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There is no obligation to always call all implementing function,
but in practice, this is often needed.</p>
<p>Note that this defeats the entire purpose of having runtime polymorphism.
This is partly why the diamond is considered ‘deadly’.</p>
<hr class="docutils" />
<div class="admonition-more-to-explore admonition">
<p class="first admonition-title">More to Explore</p>
<ul class="last simple">
<li><a class="reference external" href="https://isocpp.org/wiki/faq/basics-of-inheritance">Ineritance basics</a>
from the C++ FAQ</li>
<li>Effective C++ #35: Make sure public inheritance models “IS-A”</li>
<li>Effective C++ #36: Never redefine inherited non-virtual functions</li>
<li><a class="reference external" href="https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose">Composition vs. Inheritance: How to Choose?</a></li>
</ul>
</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 13.3. Composition' data-toggle="tooltip">
    <a href="composition.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="composition.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 14. Memory Management' data-toggle="tooltip" >
    <a href="../class-IV-memory/toctree.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="../class-IV-memory/toctree.html" >Next Section - 14. Memory Management</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017-2018 Dave Parillo.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> 3.2.6.
    </p>
  </div>
</footer>



  </body>
</html>